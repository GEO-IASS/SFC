\documentclass[a4paper, 12pt]{article}
\usepackage[left=1.5cm, text={18cm, 25cm}, top=2.5cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[czech]{babel}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{float}
\usepackage{amsmath}
\newcommand{\myuv}[1]{\quotedblbase #1\textquotedblleft}

\title{Optimalizační algoritmus ACO, technická dokumentace}
\author{Martin Hruška, xhrusk16@stud.fit.vutbr.cz}

\date{}
\begin{document}

\maketitle

\section{Úvod}
\label{sec:intro}
Ant colony optimization (ACO), neboli Optimalizace mravenčí kolonií je optimalizační algoritmus spadající do umělé inteligence,
konkrétně patří mezi metody inteligence hejna. Algoritmus hledá optimální řešení pomocí vzájemně komunikujících agentů (umělých mravenců), kteří
inkrementálně hledají nejlepší cestu grafem s~váženými hranami \cite{aco:main}. 
Z~tohoto důvodu musí být optimalizační problém popsatelný právě váženým grafem, tudíž se metoda používá především pro řešení diskrétních problémů.

Cílem této práce je vytvoření nástroje pro demonstraci činnosti ACO algoritmu, který umožní s~algoritmem experimentovat, zároveň bude jednoduše rozširitelný
o~další modifikace algoritmu, ale již v~základní verzi bude implementovat více verzí algoritmu. Implementačním jazykem je C++ a je použit objektově orientovaný
přístup pro zvýšení modifikovatelnosti a rozšiřitelnosti kódu. Nástroj má podobu aplikace s~rozhraním v~příkazové řádce.

V~tomto dokumetu bude popsán samotný algoritmus \ref{sec:algorithm}, dále architektura aplikace \ref{sec:design},
některé implementační detaily \ref{sec:implementation}, experimenty provedené s~algoritmem a jejich vyhodnocení \ref{sec:eval}.
Součástí dokumentu jsou dvě přílohy obsahující uživatelskou příručku \ref{app:help} a popis formátu vstupního grafu \ref{app:format}.
% neco o aco algoritmus, co je cilem teto prace - rozsiritelnost, lehka pouzitelnost a moznost experimentovani, osnovu

\section{ACO Algoritmus}
\label{sec:algorithm}
% obecny popis, dat nejakou intuici, pripadne obrazek
Jak bylo uvedeno v~úvodu \ref{sec:intro}, algoritmus pracuje s~množinou mravenců, kteří inkrementálně budují řešení daného optimalizačního problému tak, že
hledají optimální cestu ve váženém grafu popisujícím daný problém. Za řešení úlohy považujme cestu procházející všemi vrcholy grafu právě jednou s~tím, že se
mravenec nakonec cesty vrací do počátečního uzlu. Váhy hran grafu udávají vzdálenost vrcholů, které spojují. Každá hrana také má určitou hladinu feromonu, který
vypouští mravenci při každém průchodu. Existují různé varianty ACO algoritmu, nyní bude ovšem posána jeho základní verze nazvaná Ant System.

Řešení optimalizačního problému probíhá v~zadaném počtu iterací, při čemž v~každé iteraci vytvoří každý mravenec svoje řešení.
Počáteční uzel, ze kterého každý mravenec začiná vytvářet cestu je vybrán náhodně.
V~každém kroku tvorby řešení musí mravenec zvolit další hranu, po níž bude pokračovat do dalšího uzlu. Volba hrany záleží na vzdálenosti uzlů, které spojuje, a
hladině feromonu na dané hraně. Ty určují pravděpodobnost, se kterou si mravenec vybere danou hranu dle následujícího vzorce:
\begin{center}
  $p(c_{ij}|s_k^p) =
   \begin{cases} 
      \frac{\tau^{\alpha}_{ij}\eta^{\beta}_{ij}}{\sum\limits_{c_{il}\in N(s_k^p)}{\tau^\alpha_{il}\eta^\beta_{il}}} & j \in N(s_k^p) \\
      0 & otherwise 
   \end{cases}
   $
\end{center}
kde $c_{ij}$ je hrana z~uzlu $i$ do uzlu $j$, $s_k^p$ je částečné řešení mravence $k$, $N(s_k^p)$ je množina vrcholů nepatřících do $s_k^p$, $\eta_{ij}$ je 
dáno vztem ($1/d_{ij}$), $d_{ij}$ je vzdálenost mezi uzly $i$ a $j$, $\tau_{ij}$ je hladina feromonu na hraně $c_{ij}$, $\alpha$ je váha feromonu na hraně
a $\beta$ je váha vzdálenosti $i$ a $j$.

Jakmile jsou řešení pro dané mravence hotova, najde se mravenec s~nejkvalitnějším řešním v~dané iteraci a pokud je toto lepší, než aktuálně nejlepší řešení
z~doposud provedených iterací, tak je uloženo na jeho místo.

Hladina feromonu je aktualizována na konci každé iterace a to tak, že mravenec vypouští po cestě, kterou prošel grafem, množství feromonu přímo uměrné kvalitě
ním vytvořeného řešení. V~různých verzích algoritmu se technika aktualizace feromonu, množství feromonu vypouštěného mravencem, či počet mravenců vypouštějících 
feromon může různit. V~popisované verzi Ant System je feromon na hraně z~vrcholu $i$ a $j$ aktualizován následujícím způsobem:
\begin{center}
  $\tau_{ij}=(1-\rho)\tau_{ij}+\sum\limits_{k=1}^{n}\Delta\tau_{ij}^k$
\end{center}
kde $\rho \in <0,1>$ je evaporační koeficient a $\Delta\tau_{ij}^k$ je množství fermon přidaný na hranu z~$i$ do $j$ $k$-tým mravencem a je definováno následovně:
\begin{center}
  $\Delta\tau_{ij}^k = 
  \begin{cases}
    \frac{Q}{L_k} & \emph{pokud je hrana } ij \emph{ v~řešení k-tého mravence}\\
    0 & jinak
   \end{cases}
   $
\end{center}
kde $Q$ je konstanta udávající feromon vyloučený jedním mravence a $L_k$ je cena řešení (t.j. délka cesty) $k$-tého mravence.

Algoritmus je prováděn, dokud není dosažen počet iterací zadaný uživatelem.

\subsection{Modifikace}
\label{subsec:modif}
V~předchozí částí byl popsán ACO algoritmus v~jeho základní verzi -- Ant System. Existují ovšem modifikace tohoto přístupu.
V~následující části dokumentu budou popsány napřed modifikace Ant System algoritmu a to Ant Density, Ant Quality, Elitist Strategy, dále budou
také uvedeny alternativní ACO algoritmy k~Ant System a to Ant Colony System, Max-Min System a Rank-based System.

\subsubsection{Ant Density}
Jedná se o~modifikaci Ant system, kde je hodnota $\Delta\tau_{ij}^k$ (množství fermonu přidaného na hranu z~$i$ do $j$ $k$-tým mravencem) definována
následovně \cite{aco:variations}:
\begin{center}
  $\Delta\tau_{ij}^k = 
  \begin{cases}
    Q & \emph{pokud je hrana } ij \emph{ v~řešení k-tého mravence}\\
    0 & jinak
   \end{cases}
   $
\end{center}

\subsubsection{Ant Quality}
Jde opět o~modifikaci Ant System upravující definici $\Delta\tau_{ij}^k$ (množství fermonu přidaného na hranu z~$i$ do $j$ $k$-tým mravencem) na následující
tvar \cite{aco:variations}:
\begin{center}
  $\Delta\tau_{ij}^k = 
  \begin{cases}
    Q/d_{ij} & \emph{pokud je hrana } ij \emph{ v~řešení k-tého mravence}\\
    0 & jinak
   \end{cases}
   $
\end{center}

\subsubsection{Elitist Strategy}
Elitist Strategy je další z~variací Ant System. Je založena na odlišné aktualizaci feromonové stopy na cestě, která je prozatím vybrána jako nejlepší.
Hrany této cesty jsou aktualizovány dle následujícího vztahu\cite{aco:variations}:
\begin{center}
  $\tau_{ij}=(1-\rho)\tau_{ij}+\sum\limits_{k=1}^{n}\Delta\tau_{ij}^k + e*Q/L^*$
\end{center}
kde $e$ je počet mravenců, kteří prošli přes hranu $ij$ (která patří do nejkratší cesty), $L^{*}$ je délka nejlepší cesta.

Hrany, které nepatří do nejlepší cesty, jsou aktualizovány dle vztahu uvedeného výše v~části \ref{sec:algorithm}.

\subsubsection{Ant Colony System}
Ant Colony System je po Ant System další algoritmus založený na ACO. Přístup k~aktualizaci feromonu na hranách zůstal zachován, ale byl změněn způsob
výběru dalšího vrcholu, do kterého má pokračovat mravenec při tvorbě svého řešení v~dané iteraci. Výběr vrcholu $j$ pro daší cestu $k$-tého mravence
je proveden následovně \cite{aco:acs}:
\begin{center}
  $j = 
  \begin{cases}
    \arg\max\limits_{u\in N(s^p_k)}\tau_{iu}\eta^{\beta}_{iu} & if\ q\leq q_0\\
    \emph{Výběr dle pravděpodobnosti stejně jako v~AS} & jinak
   \end{cases}
   $
\end{center}
kde $q_0\in (0,1)$ je předem zadaný parametr a $q$ náhodné číslo generované pomocí uniformního rozložení z~intervalu $<0,1>$.

\subsubsection{Max-Min Ant System}
Max-Min Ant system je dalším ACO algoritmem. Od Ant System se odlišuje způsobem aktualizace feromonu na hranách a to tak, že feromon vypouští pouze
nejlepší mravenec (označme ho \emph{best}). Aktualizace feromonu na hranách je pak prováděna následovně \cite{aco:maxmin}:
\begin{center}
  $\tau_{ij}=(1-\rho)\tau_{ij}+\Delta\tau_{ij}^{best}$
\end{center}
kde $\Delta\tau_{ij}^{best}=\frac{1}{L_{best}}$ a hrana $ij$ je v~nejlepší cestě dané iterace.

Hodnota feromonu je pak upravene tak, že přesahuje-li předem danou maximální hranici, je na ni zmenšena. Symetricky toto platí pro minimální hranici. Formálně
zapsáno \cite{aco:maxmin}:
\begin{center}
  $\tau_{ij} = 
  \begin{cases}
    \tau_{ij} & \tau_{min} \leq \tau_{ij} \leq \tau_{max}\\
    \tau_{min} & \tau_{min} \geq \tau_{ij}\\
    \tau_{max} & \tau_{max} \leq \tau_{ij}\\
   \end{cases}
   $
\end{center}
kde $\tau_{min}$ a $\tau_{max}$ jsou předem dané parametry určující minimální, respektive maximální možné hodnoty feromonu na hranách.

\subsubsection{Rank-based Ant system}
Ve variantě Rank-based Ant system provádí aktualizaci feromnu jen předem daný počet nejlepších mravenců, kteří jsou hodnoceny dle délky své cesty.
Navíc je množství feromonu vypouštěného mravencem přímo uměrné kvalitě jeho cesty (t.j. mravenci s~kratší cestou vypouští víc feromonu). Je zřejmé,
že pro účely tohoto algoritmu je nutné mravence seřadit dle délky jejich cesty, kde nejlepší bude nejkratší cesta. Aktualizace feromonu na hranách pak
probíhá takto \cite{aco:ranked}:
\begin{center}
  $\tau_{ij}=(1-\rho)\tau_{ij}+\sum\limits_{k=1}^{\sigma-1}\Delta\tau_{ij}^k + \Delta\tau_{ij}^*$
\end{center}
  kde $\sigma$ je předem zadaný počet nejlepších mravenců, kteří budou vypouštět feromon, a $\Delta\tau_{ij}^k$ je definováno následovně
\begin{center}
  $\Delta\tau_{ij}^k = 
 \begin{cases}
  (\sigma - k)\frac{Q}{L_k} & \emph{pokud je hrana } ij \emph{ v~řešení k-tého mravence}\\
  0 & jinak
 \end{cases}
$
\end{center}
a $\Delta\tau_{ij}^*$ takto:
\begin{center}
$\Delta\tau_{ij}^* = 
 \begin{cases}
  \sigma\frac{Q}{L^*} & \emph{pokud je hrana } ij \emph{ v~nejlepší cestě}\\
  0 & jinak
 \end{cases}
   $
\end{center}
kde $L^*$ je cena nejlepší nalezené cesty.

% jake jsou rozsireni algoritmu
\section{Návrh}
\label{sec:design}
% rozhozeni do trid, core tridy
\subsection{Modularita}
\label{subsec:modularity}
% popsat moznost rozsireni, trade of obecnost/zbytecne parametry

\section{Implementace}
\label{sec:implementation}
% implementace

\section{Experimenty a vyhodnocení}
\label{sec:eval}
% popsat nejaky rozumny graf/nakreslit ho -> udelat graf vzadelnosti odchylek v zavislosti na poradi prochazky

\section{Závěr}
\label{sec:concl}
% zhodnit co bylo udelano - knihovna pro experimentovani, snadno rozsiritelna

\appendix
\section{Uživatelský manuál}
\label{app:help}
\section{Formát vstupního souboru}
\label{app:format}

\newpage
\bibliography{literatura}
\bibliographystyle{czechiso}
\end{document}
